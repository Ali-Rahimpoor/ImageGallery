import{r as o,C as N,j as e,L as y}from"./index-CXucG-lp.js";import{g as b,G as w,s as j,a as k,S as v}from"./SkeletonLoader-eQ67Ou6L.js";const C=(l,m,x)=>{const[c,t]=o.useState(!1),[f,r]=o.useState([]),[n,h]=o.useState(!1),i=o.useCallback(async()=>{try{switch(t(!0),r([]),m>0&&(localStorage.removeItem("apod_data"),localStorage.removeItem("mars_photos"),h(!0)),l){case"APOD":const a="apod_data";if(!n){const d=b(a);if(d){r(d.sort(()=>.5-Math.random()).slice(0,9));return}}const{data:s}=await k();n||j(a,s),r(s.sort(()=>.5-Math.random()).slice(0,9));break;case"MARS":const p=Math.floor(Math.random()*4e3),g="mars_photos";if(!n){const d=b(g);if(d){r(d.sort(()=>.5-Math.random()).slice(0,12));return}}const{data:u}=await w(p);n||j(g,u.photos),r(u.sort(()=>.5-Math.random()).slice(0,12));break;default:throw new Error("Invalid title")}}catch(a){throw console.error(a),new Error(a)}finally{t(!1),x(0),h(!1)}},[l,m]);return o.useEffect(()=>{i()},[i]),{images:f,loading:c,fetchImages:i}},_=()=>{const{title:l}=o.useContext(N),[m,x]=o.useState(0),{images:c,loading:t,fetchImages:f}=C(l,m,x),r=()=>{x(a=>a+1)},n=()=>{f()},h=a=>{window.open(a.hdurl||a.url,"_blank")},i=a=>{window.open(a.img_src,"_blank")};return t?e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"container font-Karla mt-2 p-2 md:gap-8 xs:gap-7 gap-4 grid grid-cols-2 sm:grid-cols-3",children:Array.from({length:l==="APOD"?9:18}).map((a,s)=>e.jsx(v,{},s))}),e.jsx("nav",{className:"flex items-center justify-center bg-gradient-to-tl from-zinc-900 to-zinc-600 p-2",children:e.jsx("button",{disabled:!0,className:"shadow text-xl font-Karla bg-white/5 text-gray-200 px-8 py-2 rounded",children:e.jsx("span",{className:"animate-spin",children:"↻"})})})]}):c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 font-Karla",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"No images found"}),e.jsx("h2",{className:"text-red-400",children:"Go to APOD and click SkipCache in bottom"}),e.jsx("button",{className:"mt-4 shadow text-xl font-Karla bg-black/75 text-gray-200 px-8 py-2 rounded",children:e.jsx(y,{to:"/home",children:"↻ Try Again"})})]}):e.jsxs(e.Fragment,{children:[l==="APOD"?e.jsx("section",{className:"container font-Karla mt-2 p-2 md:gap-8 xs:gap-7 gap-4 grid grid-cols-2 sm:grid-cols-3",children:c.map((a,s)=>e.jsxs("div",{onDoubleClick:()=>h(a),className:"relative sm:hover:scale-95 sm:transition-transform cursor-pointer",children:[e.jsx("img",{className:"w-full h-fit rounded-md object-cover",src:a.hdurl||a.url,alt:"Photo",loading:"lazy"}),e.jsxs("div",{className:"text-gray-200",children:[e.jsx("p",{className:"absolute line-clamp-1 shadow md:text-sm bg-black/20 p-1 text-[10px] xs:text-xs md:top-3 top-1 left-1 md:left-3",children:a.title}),e.jsx("p",{className:"absolute md:bottom-2 bottom-1 text-[9px] xs:text-xs md:text-base line-clamp-1 right-1 md:right-2 bg-black/20 shadow p-1 font-KarlaBold tracking-wide",children:a.date})]})]},s))}):e.jsx("section",{className:"container font-Karla mt-2 p-2 md:gap-8 xs:gap-7 gap-4 grid grid-cols-2 sm:grid-cols-3",children:c.map((a,s)=>{var p;return e.jsxs("div",{onDoubleClick:()=>i(a),className:"relative sm:hover:scale-95 sm:transition-transform cursor-pointer",children:[e.jsx("img",{src:a.img_src,className:"w-full h-fit rounded-md object-cover",alt:"Photo",loading:"lazy"}),e.jsxs("div",{children:[e.jsx("p",{className:"absolute sm:top-3 top-1 left-1 sm:left-3 bg-black/20 text-xs sm:text-base text-gray-200 rounded-sm sm:px-2 px-1 py-1",children:(a==null?void 0:a.earth_date)||"NODate"}),e.jsx("p",{className:"absolute xs:bottom-2 bottom-1 p-1 rounded text-[9px] sm:text-xs bg-black/20 right-1 xs:right-2 text-gray-200",children:((p=a==null?void 0:a.camera)==null?void 0:p.name)||"NoName"})]})]},s)})}),e.jsxs("nav",{className:"flex gap-x-2 items-center justify-center bg-gradient-to-tl from-zinc-900 to-zinc-600 p-2",children:[e.jsx("button",{onClick:r,disabled:t,className:"shadow text-xl font-Karla bg-white/5 text-gray-200 px-8 cursor-pointer py-2 rounded",children:t?e.jsx("span",{className:"animate-spin",children:"↻"}):e.jsx("span",{className:"xs:text-base text-sm",children:"(Skip Cache)"})}),e.jsx("button",{onClick:n,disabled:t,className:"shadow text-xl font-Karla bg-white/5 text-gray-200 px-8 cursor-pointer py-2 rounded",children:t?e.jsx("span",{className:"animate-spin",children:"↻"}):e.jsx("span",{className:"xs:text-base text-sm",children:"↻ Refresh"})})]})]})};export{_ as default};
